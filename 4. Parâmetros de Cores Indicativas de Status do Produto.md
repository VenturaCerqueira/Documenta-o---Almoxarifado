# 4. ParÃ¢metros de Cores Indicativas de Status do Produto ğŸŸ¢ğŸŸ¡ğŸ”´

## âœ… - Objetivo :

### ğŸ§‘ğŸ»- SolicitaÃ§Ã£o usuÃ¡rio:

Sinalizar visualmente os itens do estoque com cores (Verde, Amarelo, Vermelho) para indicar a criticidade, priorizando a **proximidade da data de validade** a fim de evitar perdas por vencimento.

---

### ğŸ’» - Rota/tela:

**âœ… -  Route**
http://www.keepinformatica.com.br/almoxarifado/web/relatorio/posicao-almoxarifado

---

### ğŸ“ƒ - DescriÃ§Ã£o:

A lÃ³gica atualmente implementada baseia-se na estimativa de quantos dias o estoque disponÃ­vel pode atender Ã  demanda, com base no consumo mÃ©dio recente. A partir disso, Ã© adotado um sistema de semÃ¡foro que utiliza cores para comunicar, de maneira lÃºdica e visualmente intuitiva, a situaÃ§Ã£o dos itens no relatÃ³rio â€œPosiÃ§Ã£oâ€.

SerÃ£o apresentadas duas formas de anÃ¡lise:

1. Uma baseada na projeÃ§Ã£o dos dias restantes de estoque (quantidade disponÃ­vel);
2. Outra considerando o tempo atÃ© o vencimento do item (data de validade).

---

### â˜‘ï¸ - Resumo das alteraÃ§Ãµes:

* [ ]  CriaÃ§Ã£o de um semÃ¡foro de validade dos itens ğŸŸ¢ğŸŸ¡ğŸ”´, usando a lÃ³gica: SinalizaÃ§Ã£o por Dias de Estoque Restante;

## âš–ï¸ - Regras:

#### â˜‘ï¸- Condicionais:

* [ ]  Definir a Cor com Base nos Dias de Estoque Restante:

* Se `Dias_Estoque_Restante` <= 7: **Vermelho** ğŸ”´ (Estoque crÃ­tico baixo)
* Se `Dias_Estoque_Restante` > 7 E `Dias_Estoque_Restante` <= 20: **Amarelo** ğŸŸ¡ (Estoque em atenÃ§Ã£o)
* Se `Dias_Estoque_Restante` > 20: **Verde** ğŸŸ¢ (Estoque confortÃ¡vel)

* [ ]  Definir a Cor com Base nos Dias Para Vencer:

* Se `Dias_Para_Vencer` <= 30: **Vermelho** ğŸ”´ (Vencimento muito prÃ³ximo)
* Se `Dias_Para_Vencer` > 30 E `Dias_Para_Vencer` <= 90: **Amarelo** ğŸŸ¡ (Vencimento em mÃ©dio prazo)
* Se `Dias_Para_Vencer` > 90: **Verde** ğŸŸ¢ (Vencimento distante)
  * *(Nota: Os prazos como 30/90 dias sÃ£o apenas exemplos e podem ser ajustados).

## ğŸ”¢ - CÃ¡lculos:

**Passo 1: Calcular o Consumo MÃ©dio DiÃ¡rio (Ãºltimos 90 dias) jÃ¡ criado no documento 3. CÃ¡lculo de estoque MÃ¡ximo e quantidade**

* **`Data de ReferÃªncia`**:  Definir como a data atual (data_final => 'Data de ReferÃªncia') [ RelatorioPosicaoForm.php].
* **`QTD_Total`**: Somar a quantidade total movimentada (saÃ­das/consumo) do produto nos 90 dias anteriores Ã  `Data de ReferÃªncia`.
  * *Exemplo (Conceitual):*
    ```sql
    SUM(Quantidade)
    WHERE TipoMovimento = 'Saida'
      AND DataMovimento BETWEEN (DataReferencia - 90 dias) AND DataReferencia
    ```
* **`consumo_Medio_Diario`**: `QTD_Total/90`

**Passo 2: Calcular os Dias de Estoque Restante**

* **`Saldo_Total_Atual`**: Obter o saldo de estoque fÃ­sico atual do produto.
* **`Dias_Estoque_Restante`**: `Saldo_Total_Atual / Consumo_Medio_Diario`
  * *(Nota: Tratar divisÃ£o por zero se `Consumo_Medio_Diario` for 0).*

**Passo 3: Definir a Cor com Base nos Dias de Estoque Restante**

* Se `Dias_Estoque_Restante` <= 7: **Vermelho** ğŸ”´ (Estoque crÃ­tico baixo)
* Se `Dias_Estoque_Restante` > 7 E `Dias_Estoque_Restante` <= 20: **Amarelo** ğŸŸ¡ (Estoque em atenÃ§Ã£o)
* Se `Dias_Estoque_Restante` > 20: **Verde** ğŸŸ¢ (Estoque confortÃ¡vel)

### 4.3. Proximidade da Validade:

Para atender ao pedido de sinalizar por **proximidade da validade** sera necessÃ¡rio acessar a data de validade registrada nos Lotes:

**Passo 1: Obter a Data de Validade**

* Para cada Lote do produto em estoque, obter a `Data_Validade`. Considerar o lote com a data de validade mais prÃ³xima.

**Passo 2: Calcular Dias Para Vencer**

* **`Dias_Para_Vencer`**: `Data_Validade - Data_Atual`

**Passo 3: Definir a Cor com Base nos Dias Para Vencer******

* Se `Dias_Para_Vencer` <= 30: **Vermelho** ğŸ”´ (Vencimento muito prÃ³ximo)
* Se `Dias_Para_Vencer` > 30 E `Dias_Para_Vencer` <= 90: **Amarelo** ğŸŸ¡ (Vencimento em mÃ©dio prazo)
* Se `Dias_Para_Vencer` > 90: **Verde** ğŸŸ¢ (Vencimento distante)

  * *(Nota: Os prazos como 30/90 dias sÃ£o apenas exemplos e podem ser ajustados).*

## 4.1 - Parametros ReposiÃ§Ã£o (ğŸ”´ğŸŸ¢âšª)

Cor menor que (prazo_reposiacao) = vermelho senÃ£o Ã© verde; <br>

Caso Prazo para reposiÃ§Ã£o sejÃ¡ igual 0 ou null => cor sera igual âšª - cinza


| Codgo produto | DescriÃ§Ã£o | UN. | Lote     | CMD | Saldo | Custo Total | N.Estoque | Prazo ReposiÃ§Ã£o | reposiÃ§Ã£o |
| ------------- | ----------- | --- | -------- | --- | ----- | ----------- | --------- | ----------------- | ----------- |
| 12            | Ãlcoo      | UND | Sem Lote | --  | --    | ---         | ğŸ”´        | --                |             |
